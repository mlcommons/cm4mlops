{
  "alias": "run-terraform",
  "automation_alias": "script",
  "automation_uid": "5b4e0237da074764",
  "cache": true,
  "category": "Cloud automation",
  "category_sort": 7000,
  "clean_files": [],
  "deps": [
    {
      "tags": "get,terraform"
    }
  ],
  "tags": [
    "run",
    "terraform"
  ],
  "new_env_keys": [
    "CM_TERRAFORM_RUN_DIR",
    "CM_TERRAFORM_CONFIG_DIR"
  ],
  "new_state_keys": [
    "CM_TF_NEW_INSTANCES_STATE"
  ],
  "uid": "ec344bd44af144d7",
  "post_deps": [
    {
      "names": [
        "destroy-cmd"
      ],
      "tags": "destroy,terraform",
      "enable_if_env": {
        "CM_DESTROY_TERRAFORM": [ "on" ]
      },
      "dynamic": true
    }
  ],
  "input_mapping": {
    "destroy": "CM_DESTROY_TERRAFORM",
    "cminit": "CM_TERRAFORM_CM_INIT",
    "key_file": "CM_SSH_KEY_FILE",
    "run_cmds": "CM_TERRAFORM_RUN_COMMANDS",
    "ssh_key_file": "CM_SSH_KEY_FILE"
  },
  "default_env": {
    "TF_VAR_SECURITY_GROUP_ID": "sg-0783752c97d2e011d",
    "TF_VAR_CPU_COUNT": "1"
  },
  "variations": {
    "aws": {
      "group": "cloud-provider",
      "default": true,
      "default_variations": {
        "aws-instance-type": "t2.micro"
      },
      "env": {
        "CM_TERRAFORM_CONFIG_DIR_NAME": "aws"
      }
    },
    "gcp": {
      "group": "cloud-provider",
      "default_variations": {
        "gcp-instance-type": "f1-micro",
        "gcp-instance-image": "ubuntu-2204-jammy-v20230114",
        "region": "region.us-west1",
        "zone": "zone.us-west1-a",
        "storage-size": "storage_size.120",
        "instance-name": "instance_name.microubuntu2204"
      },
      "default_env": {
        "TF_VAR_SSH_PUB_KEY_FILE": "$HOME/.ssh/id_rsa.pub",
        "TF_VAR_SSH_USER": "asuresh"
      },
      "env": {
        "CM_TERRAFORM_CONFIG_DIR_NAME": "gcp"
      }
    },
    "f1-micro": {
      "base": [
        "gcp"
      ],
      "group": "gcp-instance-type",
      "env": {
        "TF_VAR_INSTANCE_TYPE": "f1-micro"
      }
    },
    "t2.micro": {
      "group": "aws-instance-type",
      "base": [
        "aws"
      ],
      "env": {
        "TF_VAR_INSTANCE_TYPE": "t2.micro"
      }
    },
    "c5.4xlarge": {
      "group": "aws-instance-type",
      "base": [
        "aws"
      ],
      "env": {
        "TF_VAR_INSTANCE_TYPE": "c5.4xlarge"
      }
    },
    "c5.12xlarge": {
      "group": "aws-instance-type",
      "base": [
        "aws"
      ],
      "env": {
        "TF_VAR_INSTANCE_TYPE": "c5.12xlarge"
      }
    },
    "c5d.9xlarge": {
      "group": "aws-instance-type",
      "base": [
        "aws"
      ],
      "env": {
        "TF_VAR_INSTANCE_TYPE": "c5d.9xlarge"
      }
    },
    "g4dn.xlarge": {
      "group": "aws-instance-type",
      "base": [
        "aws"
      ],
      "env": {
        "TF_VAR_INSTANCE_TYPE": "g4dn.xlarge"
      }
    },
    "storage_size.8": {
      "group": "storage-size",
      "default": true,
      "env": {
        "TF_VAR_DISK_GBS": "8"
      }
    },
    "storage_size.#": {
      "group": "storage-size",
      "env": {
        "TF_VAR_DISK_GBS": "#"
      }
    },
    "region.#": {
      "group": "region",
      "env": {
        "TF_VAR_INSTANCE_REGION": "#"
      }
    },
    "zone.#": {
      "group": "zone",
      "env": {
        "TF_VAR_INSTANCE_ZONE": "#"
      }
    },
    "gcp_instance_type.#": {
      "group": "gcp-instance-type",
      "env": {
        "TF_VAR_INSTANCE_TYPE": "#"
      }
    },
    "aws_instance_type.#": {
      "group": "aws-instance-type",
      "env": {
        "TF_VAR_INSTANCE_TYPE": "#"
      }
    },
    "gcp_project.#": {
      "group": "gcp-project",
      "env": {
        "TF_VAR_GCP_PROJECT": "#"
      }
    },
    "aws_instance_image.#": {
      "group": "aws-inastance-image",
      "env": {
        "TF_VAR_INSTANCE_IMAGE": "#"
      }
    },
    "gcp_instance_image.#": {
      "group": "gcp-instance-image",
      "env": {
        "TF_VAR_INSTANCE_IMAGE": "#"
      }
    },
    "debian-cloud/debian-11": {
      "group": "gcp-instance-image",
      "env": {
        "TF_VAR_INSTANCE_IMAGE": "debian-cloud/debian-11"
      }
    },
    "ubuntu-2204-jammy-v20230114": {
      "group": "gcp-instance-image",
      "env": {
        "TF_VAR_INSTANCE_IMAGE": "ubuntu-2204-jammy-v20230114"
      }
    },
    "instance_name.#": {
      "group": "instance-name",
      "env": {
        "TF_VAR_INSTANCE_NAME": "#"
      }
    }
  }
}
